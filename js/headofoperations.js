var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};!function(){var t=function(t){function e(e,i,s,o,h,r){void 0===h&&(h="head-a.png"),void 0===r&&(r=10),t.call(this,e,h),this.name="游客"+(new Date).getTime().toString().substr(-5),this.score=0,this.score=r,this.setSize(),this.url=h,this.shape=SHAPE.circle,this.name=o||this.name}return __extends(e,t),e.prototype.draw=function(e){this.setSize(),t.prototype.draw.call(this,e);var i=new WriteText(this.context);i.write(this.name,this.x,this.y+this.r,null,"#cccccc")},e.prototype.drop=function(t){this.setPosition(this.x,this.y+t)},e.prototype.eat=function(t){var e=this;void 0===t&&(t="eat-a.png"),this.setImg(t),setTimeout(function(){return e.setImg(e.url)},300)},e.prototype.setSize=function(){var e=5*Math.sqrt(this.score);t.prototype.setSize.call(this,2*e,2*e)},e}(Sprite),e=function(t){function e(e){t.call(this,e,10,10,void 0,"head.png"),this.context=e,this.score=0,this.angle=0,this.v=1,this.vx=this.v,this.vy=this.v;var i=10+Math.floor(10*Math.random());this.score=i;var s=Math.floor(Math.random()*names.length-1);this.name=names[s],names.splice(s,1),this.trans(),this.setSize()}return __extends(e,t),e.prototype.trans=function(){return this.angle=Math.atan2(-1+2*Math.random(),-1+2*Math.random()),this.angle},e.prototype.move=function(t){var e=0;1e3*Math.random()<3&&this.trans(),e=-this.angle,0!=e&&(this.vx=Math.cos(e)*this.v,this.vy=Math.sin(e)*this.v),this.x=this.vx+this.x,this.y=this.y-this.vy,this.x=Math.max(0,this.x),this.x=Math.min(this.x,t.width-this.w),this.y=Math.max(0,this.y),this.y=Math.min(this.y,t.height-this.h),0!=this.x&&0!=this.y&&this.x!=t.width-this.w&&this.y!=t.height-this.h||this.trans()},e.prototype.draw=function(){t.prototype.draw.call(this,this.angle)},e.prototype.eat=function(){t.prototype.eat.call(this,"eat.png")},e}(t),i=function(i){function o(){i.apply(this,arguments),this.roleSize=10,this.v=1,this.av=0,this.vx=this.v,this.vy=this.v,this.ballList=[],this.score=10,this.zdList=[],this.robotList=[],this.decompose=!1,this.decomposeV=0}return __extends(o,i),o.prototype.newGame=function(){this.init(),this.createRole(),this.createRobot(),i.prototype.newGame.call(this),this.createAccelerate()},o.prototype.createAccelerate=function(){var t=this;this.accelerate=new s,this.view.appendChild(this.accelerate.create(function(e){t.v=5,t.decompose=!0},function(e){t.v=1,t.decompose=!1}))},o.prototype.init=function(){this.score=10,this.ballList=[],this.zdList=[],this.robotList=[]},o.prototype.createRobot=function(){for(var t=this.robotList.length;t<15;t++){var i=new e(this.context);i.x=Math.random()*this.stage.width,i.y=Math.random()*this.stage.height,i.r=i.h/2,this.robotList.push(i)}if(this.decomposeV++,this.decompose&&this.decomposeV>=5&&this.role.score>0){console.log("分解了"),this.decomposeV=0;var s=new Sprite(this.context,"head.png");s.setSize(5,5),s.x=this.vx>0?this.role.x+this.role.r-1*(this.vx+this.role.w):this.role.x+this.role.w-this.vx,s.y=this.vy<0?this.role.y+this.role.r-1*(this.vy+this.role.h):this.role.y+this.role.h+this.vy,s.shape=SHAPE.circle,s.setPosition(s.x,s.y),this.ballList.push(s),this.role.score--,this.role.setSize()}},o.prototype.createRole=function(){this.role=new t(this.context,this.roleSize,this.roleSize),this.role.x=this.stage.width/2,this.role.y=this.stage.height/2,this.role.r=this.role.h/2},o.prototype.running=function(){i.prototype.running.call(this),this.move(),this.role.draw(this.angle),this.createBallList(),this.drawBallList(),this.checkHits(),this.drawZdList(),this.drawRobot(),this.createRobot(),this.moveScreen(),this.scoreScreen.change("得分："+this.role.score.toString())},o.prototype.moveScreen=function(){var t=this.view.clientHeight,e=this.view.clientWidth,i=Math.floor(this.role.x+this.role.r-e/2),s=Math.floor(this.role.y+this.role.r-t/2),o=this.stage.width-e,h=this.stage.height-t;this.stage.elem.style.left=-Math.min(o,Math.max(0,i))+"px",this.stage.elem.style.top=-Math.min(h,Math.max(0,s))+"px"},o.prototype.drawZdList=function(){this.zdList.forEach(function(t){t.draw()})},o.prototype.drawRobot=function(){var t=this;this.robotList.forEach(function(e){e.move(t.stage),e.draw()})},o.prototype.createZd=function(){for(var t=0;t<4;t++){var e=new Sprite(this.context,"zd.png");this.zdList.push(e),e.setSize(10,10);var i=this.stage.width/4,s=this.stage.height/4;0==t&&e.setPosition(i,s),1==t&&e.setPosition(this.stage.width-i,s),2==t&&e.setPosition(i,this.stage.height-s),3==t&&e.setPosition(this.stage.width-i,this.stage.height-s),e.shape=SHAPE.circle}},o.prototype.checkHits=function(){var t=this;this.ballList.forEach(function(e,i){t.hits(t.role,e)&&(t.role.score++,t.role.setSize(),t.ballList.splice(i,1),t.role.eat()),t.robotList.forEach(function(s,o){t.hits(s,e)&&(s.score++,s.setSize(),t.ballList.splice(i,1),s.eat()),t.hits(s,t.role)&&(s.score>t.role.score?t.over():s.score<t.role.score&&(t.role.score+=s.score,t.robotList.splice(o,1)))})}),this.robotList.forEach(function(e,i){t.robotList.forEach(function(s,o){i!=o&&t.hits(e,s)&&e.score!=s.score&&(e.score>s.score?(e.score+=s.score,t.robotList.splice(o,1)):(s.score+=e.score,t.robotList.splice(i,1)))})}),this.zdList.forEach(function(e){t.hits(t.role,e)&&t.over(),t.robotList.forEach(function(i,s){t.hits(i,e)&&t.robotList.splice(s,1)})})},o.prototype.drawBallList=function(){this.ballList.forEach(function(t){t.draw()})},o.prototype.createBallList=function(){for(var t=300-this.ballList.length,e=0;e<t;e++){var i=new Sprite(this.context,"head.png");this.ballList.push(i),i.setSize(5,5),i.x=Math.random()*this.stage.width,i.y=Math.random()*this.stage.height,i.shape=SHAPE.circle}},o.prototype.move=function(){var t=this.controlStage.getAngle();this.angle=-t,0!=t&&(this.vx=Math.cos(t)*this.v,this.vy=Math.sin(t)*this.v),this.role.x=this.vx+this.role.x,this.role.y=this.role.y-this.vy,this.role.x=Math.max(0,this.role.x),this.role.x=Math.min(this.role.x,this.stage.width-this.role.w),this.role.y=Math.max(0,this.role.y),this.role.y=Math.min(this.role.y,this.stage.height-this.role.h)},o.prototype.gameOver=function(){i.prototype.gameOver.call(this),this.gameOverStage.setText("得分："+this.role.score),this.accelerate.remove()},o.prototype.loading=function(){console.log("loading..."),i.prototype.loading.call(this)},o}(JY),s=function(){function t(){}return t.prototype.create=function(t,e){return this.elem=document.createElement("div"),this.elem.className="accelerate",this.elem.style.position="absolute",this.elem.style.right="10%",this.elem.style.bottom="10%",this.elem.addEventListener("touchstart",function(e){t(e)},!1),this.elem.addEventListener("touchend",function(t){e(t)},!1),this.elem},t.prototype.remove=function(){this.elem&&this.elem.parentNode.removeChild(this.elem)},t}();setTimeout(function(){var t=document.getElementById("view"),e=t.offsetWidth,s=t.offsetHeight,o=new Stage(3*e,3*s),h=new Discript("start");h.text='<p class="title">大头吃小头</p>';var r=new GameOver("restart"),n=new Title("大头吃小头"),a=new Control;a.rect=[100,100];var c=new i(t,o,n,h,r,a);c.files={image:["act.png","head.png","head-a.png","eat-a.png","eat.png","zd.png"]},c.setup()},1e3)}();
//# sourceMappingURL=headofoperations.js.map
